<div class="dashboard-container">
  <header class="dashboard-header">
    <div>
      <h1>Strategic Analytics</h1>
      <p>Performance intelligence for your intellectual property.</p>
    </div>
    <button (click)="logout()" class="logout-button">Logout</button>
  </header>

  <ng-container *ngIf="summary$ | async as summary; else loading">
    <!-- Top Metrics Grid -->
    <div class="grid-metrics">
      
      <!-- Revenue Card -->
      <div class="card metric-card">
        <div class="metric-icon revenue-icon">üí∞</div>
        <div>
          <p class="metric-label">Cumulative Revenue</p>
          <div *ngFor="let rev of summary.revenueByCurrency">
            <h2 class="metric-value">
              <span class="currency-label">{{rev.currency}}</span>
              {{rev.totalAmount | number:'1.2-2'}}
            </h2>
          </div>
          <div *ngIf="summary.revenueByCurrency.length === 0">
            <h2 class="metric-value">0.00</h2>
          </div>
        </div>
      </div>

      <!-- Portfolio Card -->
      <div class="card metric-card">
        <div class="metric-icon books-icon">üìö</div>
        <div>
          <p class="metric-label">Active Portfolio</p>
          <h2 class="metric-value">
            {{summary.totalBooksPublished}}
            <span class="unit-label">Titles</span>
          </h2>
        </div>
      </div>

      <!-- Market Volume Card -->
      <div class="card metric-card">
        <div class="metric-icon sales-icon">üìà</div>
        <div>
          <p class="metric-label">Market Volume</p>
          <h2 class="metric-value">
            {{summary.totalSalesTransactions}}
            <span class="unit-label">Sales</span>
          </h2>
        </div>
      </div>
    </div>

    <!-- Detailed Analysis Grid -->
    <div class="grid-details">
      
      <!-- YoY Growth Card -->
      <div class="card growth-card" *ngIf="yoy$ | async as yoy">
        <div class="card-header">
          <h3>Year-over-Year Growth</h3>
          <div class="growth-badge">
            ‚Üó {{yoy.growth | percent:'1.1-1'}}
          </div>
        </div>
        
        <div class="growth-stats">
          <div class="stat-row">
            <div>
              <div class="stat-label">Top Revenue Title</div>
              <div class="stat-value">{{summary.topPerformingBook}}</div>
            </div>
            <span class="stat-icon">ü•á</span>
          </div>

          <div class="stat-row">
            <div>
              <div class="stat-label">Dominant Sales Channel</div>
              <div class="stat-value">{{summary.topPerformingPlatform}}</div>
            </div>
            <span class="stat-icon">üèõÔ∏è</span>
          </div>
        </div>
      </div>

      <!-- Seasonal Performance Card -->
      <div class="card seasonal-card" *ngIf="seasonal$ | async as seasonal">
        <h3>Monthly Revenue Trajectory</h3>
        <div class="chart-container">
            <!-- Simple visual representation for now -->
            <div *ngFor="let s of seasonal" class="bar-group">
                <div class="bar" [style.height.%]="(s.totalRevenue / 1000) * 100"></div> <!-- Placeholder scaling -->
                <span class="month-label">M{{s.month}}</span>
            </div>
        </div>
      </div>

    </div>
  </ng-container>

  <ng-template #loading>
    <div class="loading-state">
      <p>Loading dashboard analytics...</p>
    </div>
  </ng-template>
</div>